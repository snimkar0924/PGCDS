{
    "contents" : "#clear the workspace of any residual data\nsetwd(\"D:/SONALI - DATA/00000 La Vita Nuova/NISM/PGCDS/TERM 1/003 Applied Econometrics/assignment 1 - movie earning prediction/Movie Earning Prediction\")\nrm(list=ls())\n\nlibrary(glmulti)\n\nboxOfficeData<-read.csv(\"./data/boxOfficeData_FM.csv\", header=TRUE, sep=\",\")\n#dim(boxOfficeData)\nattach(boxOfficeData)\ncols<-colnames(boxOfficeData)\n\n#generate a regression model using the box office data to model Lifetime earnings of the movie\n#model1<-lm(Lifetime~mvs+holiday1+Genre1+sequel+larm1+larf1+dirr1+tv_grps-1)\nmodel1<-lm(Lifetime~mvs+larm1+tv_grps-1)\nsummary(model1)\nmulti_model1<-glmulti(model1,crit=\"aicc\",method=\"g\")\nsummary(multi_model1)\nweightable(multi_model1)\n\n\n\n##\nstr<-cols[5]\nfor (i in 6:length(cols))\n{\n  str<-paste(str,\"+\",cols[i])\n}\n\n#str ->\n#\"mvs + holiday1 + Genre1 + sequel + larm1 + larf1 + dirr1 + fg + imdb + cr + tv_weeks + tv_spots + tv_channels + tv_grps + tv_spend + reach1 + reach3 + reach5 + yt_trailerviews + yt_trailerlikes + yt_trailerdislikes + yt_trailercomm + yt_moviesongv + yt_moviesonglikes + yt_moviesongdislikes + yt_moviesongcomm + fb_pagelikes + fb_pageposts + fb_newlikes + tw_follws + tw_twts + tw_faves + search_mvkywd + search_castkywd + rad6_twit + rad6_comm + rad6_news + rad6_agg + rad6_blgs + rad6_vds + rad6_twsentiP + rad6_twsentiN\"\nmodel2<-lm(Lifetime~mvs + holiday1 + Genre1 + sequel + larm1 + larf1 + dirr1 + fg + imdb + cr + tv_weeks + tv_spots + tv_channels + tv_grps + tv_spend + reach1 + reach3 + reach5 + yt_trailerviews + yt_trailerlikes + yt_trailerdislikes + yt_trailercomm + yt_moviesongv + yt_moviesonglikes + yt_moviesongdislikes + yt_moviesongcomm + fb_pagelikes + fb_pageposts + fb_newlikes + tw_follws + tw_twts + tw_faves + search_mvkywd + search_castkywd-1)# + rad6_twit + rad6_comm + rad6_news + rad6_agg + rad6_blgs + rad6_vds + rad6_twsentiP + rad6_twsentiN-1)\nsummary(model2)\nmulti_model2<-glmulti(model2,crit=\"aicc\")\nsummary(multi_model2)\nweightable(multi_model2)\n#model2 -> too large a set of explanatory variables for glmulti to process\n\n\n###so now try a set of explanatory variables that makes sense from a movie business perspective\n\n\nmodel3<-lm(Lifetime~mvs + holiday1 + Genre1 + sequel + larm1 + larf1 + dirr1 + tv_weeks + tv_spots + tv_channels + tv_grps + tv_spend + yt_trailerlikes + yt_moviesonglikes + fb_pagelikes + fb_pageposts + tw_faves + search_mvkywd -1)\nsumm<-summary(model3)\nsumm[9]\nmulti_model3<-glmulti(model3,crit=\"aicc\",method=\"g\")\n\n###now try a combination from the set (mvs + holiday1 + Genre1 + sequel + larm1 + larf1 + dirr1 + tv_weeks + tv_spots + tv_channels + tv_grps + tv_spend + yt_trailerlikes + yt_moviesonglikes + fb_pagelikes + fb_pageposts + tw_faves + search_mvkywd )\nsampleSet<-as.vector(read.csv(\"./data/sample set.csv\",header=TRUE,sep=\",\"))\nsampleResids<-c(rep(0,nrow(sampleSet)))\n\n#one parameter\nfor (i in 1:nrow(sampleSet))\n{\n\tlst<-as.vector(boxOfficeData[toString(sampleSet[i,1])])\n\tfmla<-as.formula(paste(\"Lifetime~\",colnames(lst),\"-1\"))\n\tsampleModel<-lm(fmla)\n\n\tsampleSummary<-summary(sampleModel)\n\tsampleResid[i]<-sampleSummary[9]\n}\n\n#two params\n\n\nwrite.csv(sampleResid,\"./data/residuals.csv\")\n\n\nwhich.max(sampleResid)\n\n\nn <- nrow(sampleSet)\n#r <- 0\ncou<-0\nnumCombs=NULL\nfor (k in 1:n)\n{\n\tncomb <- factorial(n)/(factorial(k)*factorial(n-k))\n\tcou<-cou+1\n\tnumCombs[cou]<-ncomb\n}\ncombi <- combn(18,9)\nncomb <- factorial(18)/(factorial(9)*factorial(18-9))\ndim(combi)\nncomb\n\n\n\nmod<-lm(Lifetime~search_mvkywd-1)\nsummary(mod)\n\nmod11<-lm(Lifetime~larm1+search_mvkywd+fg+yt_trailerviews+tw_follws-1)\nsummary(mod11)\nmulti_mod11<-glmulti(mod11,crit=\"aicc\",level=1)\nsummary(multi_mod11)\nweightable(multi_mod11)\nmod22<-lm(Lifetime~tw_follws+rad6_comm+rad6_news+rad6_blgs+rad6_vds+rad6_twsentiP+rad6_twsentiN-1)\nsummary(mod22)\n\nmod<-lm(Lifetime~sequel+larm1+tv_grps+search_mvkywd-1)\n\nmulti_mod<-glmulti(mod,crit=\"aicc\",level=1)\nsummary(multi_mod)\nweightable(multi_mod)\n\nmod1<-lm(Lifetime~-1+tv_spend+larm1:sequel+search_mvkywd:larm1)\nmod2<-lm(Lifetime~tv_spend+larm1+sequel+search_mvkywd-1)\n\nmod3<-lm(Lifetime~larm1+tv_grps+search_mvkywd+tv_grps:larm1+search_mvkywd:larm1+search_mvkywd:tv_grps-1)\nsummary(mod3)\nmulti_mod<-glmulti(mod,crit=\"aicc\",level=1)\nsummary(multi_mod)\nweightable(multi_mod)\n\n\nsummary(mod1)\nsummary(mod2)\n\n####### supplementary models \n##determine what drives search_mvkywd\nsupMod1<-lm(search_mvkywd~tw_follws+rad6_comm+rad6_news+rad6_blgs+rad6_vds+rad6_twsentiP+rad6_twsentiN-1)\nsummary(supMod1)\nsupMod1Multi<-glmulti(supMod1,level=1,crit=\"aicc\")\nsummary(supMod1Multi)\nweightable(supMod1Multi)\n\n\nmod<-lm(search_mvkywd ~ 1 + tw_follws + rad6_comm + rad6_news + rad6_blgs + rad6_vds + rad6_twsentiP)\nsummary(mod)\n\n\n\n\n\n\n\n\n",
    "created" : 1450252559623.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "780665353",
    "id" : "9F905811",
    "lastKnownWriteTime" : 1448012473,
    "path" : "D:/SONALI - DATA/00000 La Vita Nuova/NISM/PGCDS/TERM 1/003 Applied Econometrics/ASSIGNMENT 1 - go bollywood/assignment 1 - movie earning prediction/Movie Earning Prediction/scratchpad.R",
    "project_path" : "scratchpad.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}